@page "/main" 

<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from social.webestica.com/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 01 May 2024 09:27:31 GMT -->
<head>
    <title>Social Market Tracker</title>

    <!-- Meta Tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


    <!-- Dark mode -->
    @*<script>
		const storedTheme = localStorage.getItem('theme')

		const getPreferredTheme = () => {
			if (storedTheme) {
				return storedTheme
			}
			return window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'light'
		}

		const setTheme = function (theme) {
			if (theme === 'auto' && window.matchMedia('(prefers-color-scheme: dark)').matches) {
				document.documentElement.setAttribute('data-bs-theme', 'dark')
			} else {
				document.documentElement.setAttribute('data-bs-theme', theme)
			}
		}

		setTheme(getPreferredTheme())

		window.addEventListener('DOMContentLoaded', () => {
		    var el = document.querySelector('.theme-icon-active');
			if(el != 'undefined' && el != null) {
				const showActiveTheme = theme => {
				const activeThemeIcon = document.querySelector('.theme-icon-active use')
				const btnToActive = document.querySelector(`[data-bs-theme-value="${theme}"]`)
				const svgOfActiveBtn = btnToActive.querySelector('.mode-switch use').getAttribute('href')

				document.querySelectorAll('[data-bs-theme-value]').forEach(element => {
					element.classList.remove('active')
				})

				btnToActive.classList.add('active')
				activeThemeIcon.setAttribute('href', svgOfActiveBtn)
			}

			window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
				if (storedTheme !== 'light' || storedTheme !== 'dark') {
					setTheme(getPreferredTheme())
				}
			})

			showActiveTheme(getPreferredTheme())

			document.querySelectorAll('[data-bs-theme-value]')
				.forEach(toggle => {
					toggle.addEventListener('click', () => {
						const theme = toggle.getAttribute('data-bs-theme-value')
						localStorage.setItem('theme', theme)
						setTheme(theme)
						showActiveTheme(theme)
					})
				})

			}
		})

    </script>*@

    <!-- Favicon -->
    <link rel="shortcut icon" href="assets/images/favicon.ico">

    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap">

    <!-- Plugins CSS -->
    <link rel="stylesheet" type="text/css" href="assets/vendor/font-awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/bootstrap-icons/bootstrap-icons.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/OverlayScrollbars-master/css/OverlayScrollbars.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/tiny-slider/dist/tiny-slider.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/choices.js/public/assets/styles/choices.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/glightbox-master/dist/css/glightbox.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/dropzone/dist/dropzone.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/flatpickr/dist/flatpickr.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/plyr/plyr.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/zuck.js/dist/zuck.min.css">

    <!-- Theme CSS -->
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    @*<script async src="https://www.googletagmanager.com/gtag/js?id=G-GMKQ4P9YMZ"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-GMKQ4P9YMZ');
    </script>*@

</head>
<body>

    <!-- =======================
    Header START -->
    <header class="navbar-light fixed-top header-static bg-mode">

        <!-- Logo Nav START -->
        <nav class="navbar navbar-expand-lg">
            <div class="container">
                <!-- Logo START -->
                <a class="navbar-brand" href="index-2.html">
                    <img class="light-mode-item navbar-brand-item" src="assets/images/logo.svg" alt="logo">
                    <img class="dark-mode-item navbar-brand-item" src="assets/images/logo.svg" alt="logo">
                </a>
                <!-- Logo END -->
                <!-- Responsive navbar toggler -->
                <button class="navbar-toggler ms-auto icon-md btn btn-light p-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-animation">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                </button>

                <!-- Main navbar START -->
                <div class="collapse navbar-collapse" id="navbarCollapse">

                    <!-- Nav Search START -->
                    <div class="nav mt-3 mt-lg-0 flex-nowrap align-items-center px-4 px-lg-0">
                        <div class="nav-item w-100">
                            <form class="rounded position-relative">
                                <input class="form-control ps-5 bg-light" type="search" placeholder="Ara..." aria-label="Search">
                                <button class="btn bg-transparent px-2 py-0 position-absolute top-50 start-0 translate-middle-y" type="submit"><i class="bi bi-search fs-5"> </i></button>
                            </form>
                        </div>
                    </div>
                    <!-- Nav Search END -->

                    <ul class="navbar-nav navbar-nav-scroll ms-auto">
                        
                        <!-- Nav item 2 Pages -->
                        
                        <!-- Nav item 3 Post -->
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="postMenu" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Hesap Ayarları </a>
                            <ul class="dropdown-menu" aria-labelledby="postMenu">
                                <li> <a class="dropdown-item" href="profileSetting">Hesap ayarları</a> </li>

                                <li> <a class="dropdown-item" href="/logout">Çıkış Yap</a> </li>
                            </ul>
                        </li>

                        <!-- Nav item 4 Mega menu -->
                        <li class="nav-item">
                            <a class="nav-link" href="my-profile">Hesabım</a>
                        </li>
                    </ul>
                </div>
                <!-- Main navbar END -->
                <!-- Nav right START -->
                <ul class="nav flex-nowrap align-items-center ms-sm-3 list-unstyled">
                    <li class="nav-item ms-2">
                        <a class="nav-link bg-light icon-md btn btn-light p-0" href="messaging.html">
                            <i class="bi bi-chat-left-text-fill fs-6"> </i>
                        </a>
                    </li>
                    <li class="nav-item ms-2">
                        <a class="nav-link bg-light icon-md btn btn-light p-0" href="profileSetting">
                            <i class="bi bi-gear-fill fs-6"> </i>
                        </a>
                    </li>
                    <li class="nav-item dropdown ms-2">
                        <a class="nav-link bg-light icon-md btn btn-light p-0" href="#" id="notifDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-bs-auto-close="outside">
                            <span class="badge-notif animation-blink"></span>
                            <i class="bi bi-bell-fill fs-6"> </i>
                        </a>
                        <div class="dropdown-menu dropdown-animation dropdown-menu-end dropdown-menu-size-md p-0 shadow-lg border-0" aria-labelledby="notifDropdown">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h6 class="m-0">Notifications <span class="badge bg-danger bg-opacity-10 text-danger ms-2">4 new</span></h6>
                                    <a class="small" href="#">Clear all</a>
                                </div>
                                <div class="card-body p-0">
                                    <ul class="list-group list-group-flush list-unstyled p-2">
                                        <!-- Notif item -->
                                        <li>
                                            <div class="list-group-item list-group-item-action rounded badge-unread d-flex border-0 mb-1 p-3">
                                                <div class="avatar text-center d-none d-sm-inline-block">
                                                    <img class="avatar-img rounded-circle" src="@GetProfilePicturePath(user.ProfilePictureId)" alt="">
                                                </div>
                                                <div class="ms-sm-3">
                                                    <div class=" d-flex">
                                                        <p class="small mb-2"><b>Judy Nguyen</b> sent you a friend request.</p>
                                                        <p class="small ms-3 text-nowrap">Just now</p>
                                                    </div>

                                                </div>
                                            </div>
                                        </li>
                                        <!-- Notif item -->
                                        <li>
                                            <div class="list-group-item list-group-item-action rounded badge-unread d-flex border-0 mb-1 p-3 position-relative">
                                                <div class="avatar text-center d-none d-sm-inline-block">
                                                    <img class="avatar-img rounded-circle" src="assets/images/avatar/02.jpg" alt="">
                                                </div>
                                                <div class="ms-sm-3 d-flex">
                                                    <div>
                                                        <p class="small mb-2">Wish <b>Amanda Reed</b> a happy birthday (Nov 12)</p>
                                                        <button class="btn btn-sm btn-outline-light py-1 me-2">Say happy birthday 🎂</button>
                                                    </div>
                                                    <p class="small ms-3">2min</p>
                                                </div>
                                            </div>
                                        </li>
                                        <!-- Notif item -->
                                        <li>
                                            <a href="#" class="list-group-item list-group-item-action rounded d-flex border-0 mb-1 p-3">
                                                <div class="avatar text-center d-none d-sm-inline-block">
                                                    <div class="avatar-img rounded-circle bg-success"><span class="text-white position-absolute top-50 start-50 translate-middle fw-bold">WB</span></div>
                                                </div>
                                                <div class="ms-sm-3">
                                                    <div class="d-flex">
                                                        <p class="small mb-2">Webestica has 15 like and 1 new activity</p>
                                   
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <!-- Notif item -->
                                        <li>
                                            <a href="#" class="list-group-item list-group-item-action rounded d-flex border-0 p-3 mb-1">
                                                <div class="avatar text-center d-none d-sm-inline-block">
                                                    <img class="avatar-img rounded-circle" src="assets/images/logo/12.svg" alt="">
                                                </div>
                                                <div class="ms-sm-3 d-flex">
                                                    <p class="small mb-2"><b>Bootstrap in the news:</b> The search giant’s parent company, Alphabet, just joined an exclusive club of tech stocks.</p>
                                                    <p class="small ms-3">4hr</p>
                                                </div>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                              
                            </div>
                        </div>
                    </li>
                    <!-- Notification dropdown END -->

                    <li class="nav-item ms-2 dropdown">
                        <a class="nav-link btn icon-md p-0" href="#" id="profileDropdown" role="button" data-bs-auto-close="outside" data-bs-display="static" data-bs-toggle="dropdown" aria-expanded="false">
                            <img class="avatar-img rounded-2" src="@GetProfilePicturePath(user.ProfilePictureId)" alt="">
                        </a>
                        <ul class="dropdown-menu dropdown-animation dropdown-menu-end pt-3 small me-md-n3" aria-labelledby="profileDropdown">
                            <!-- Profile info -->
                            <li class="px-3">
                                <div class="d-flex align-items-center position-relative">
                                    <!-- Avatar -->
                                    <div class="avatar me-3">
                                        <img class="avatar-img rounded-circle" src="@GetProfilePicturePath(user.ProfilePictureId)" alt="avatar">
                                    </div>
                                    <div>
                                        <a class="h6 stretched-link" href="my-profile">@user.Name</a>
                                        <p class="small m-0">Web Developer</p>
                                    </div>
                                </div>
                                <a class="dropdown-item btn btn-primary-soft btn-sm my-2 text-center" href="my-profile">Profilini Görüntüle</a>
                            </li>
                            <!-- Links -->
                            <li><a class="dropdown-item" href="profileSetting"><i class="bi bi-gear fa-fw me-2"></i>Ayarlar</a></li>
                            
                         
                            <li class="dropdown-divider"></li>
                            <li><a class="dropdown-item bg-danger-soft-hover" href="/logout"><i class="bi bi-power fa-fw me-2"></i>Çıkış Yap</a></li>
                            <li> <hr class="dropdown-divider"></li>
                            <!-- Dark mode options START -->
                            <li>
                                <div class="modeswitch-item theme-icon-active d-flex justify-content-center gap-3 align-items-center p-2 pb-0">
                                    <span>Mode:</span>
                                    <button type="button" class="btn btn-modeswitch nav-link text-primary-hover mb-0" data-bs-theme-value="light" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Light">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sun fa-fw mode-switch" viewBox="0 0 16 16">
                                            <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z" />
                                            <use href="#"></use>
                                        </svg>
                                    </button>
                                    <button type="button" class="btn btn-modeswitch nav-link text-primary-hover mb-0" data-bs-theme-value="dark" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Dark">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-moon-stars fa-fw mode-switch" viewBox="0 0 16 16">
                                            <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278zM4.858 1.311A7.269 7.269 0 0 0 1.025 7.71c0 4.02 3.279 7.276 7.319 7.276a7.316 7.316 0 0 0 5.205-2.162c-.337.042-.68.063-1.029.063-4.61 0-8.343-3.714-8.343-8.29 0-1.167.242-2.278.681-3.286z" />
                                            <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z" />
                                            <use href="#"></use>
                                        </svg>
                                    </button>
                                    <button type="button" class="btn btn-modeswitch nav-link text-primary-hover mb-0 active" data-bs-theme-value="auto" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Auto">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-circle-half fa-fw mode-switch" viewBox="0 0 16 16">
                                            <path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z" />
                                            <use href="#"></use>
                                        </svg>
                                    </button>
                                </div>
                            </li>
                            <!-- Dark mode options END-->
                        </ul>
                    </li>
                    <!-- Profile START -->

                </ul>
                <!-- Nav right END -->
            </div>
        </nav>
        <!-- Logo Nav END -->
    </header>
    <!-- =======================
    Header END -->
    <!-- **************** MAIN CONTENT START **************** -->
    <main>

        <!-- Container START -->
        <div class="container">
            <div class="row g-4">

                <!-- Sidenav START -->
                <div class="col-lg-3">

                    <!-- Advanced filter responsive toggler START -->
                    <div class="d-flex align-items-center d-lg-none">
                        <button class="border-0 bg-transparent" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSideNavbar" aria-controls="offcanvasSideNavbar">
                            <span class="btn btn-primary"><i class="fa-solid fa-sliders-h"></i></span>
                            <span class="h6 mb-0 fw-bold d-lg-none ms-2">My profile</span>
                        </button>
                    </div>
                    <!-- Advanced filter responsive toggler END -->
                    <!-- Navbar START-->
                    <nav class="navbar navbar-expand-lg mx-0">
                        <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasSideNavbar">
                            <!-- Offcanvas header -->
                            <div class="offcanvas-header">
                                <button type="button" class="btn-close text-reset ms-auto" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                            </div>

                            <!-- Offcanvas body -->
                            <div class="offcanvas-body d-block px-2 px-lg-0">
                                <!-- Card START -->
                                <div class="card overflow-hidden">
                                    <!-- Cover image -->
                                    <div class="h-50px" style="background-image:url(assets/images/bg/01.jpg); background-position: center; background-size: cover; background-repeat: no-repeat;"></div>
                                    <!-- Card body START -->
                                    <div class="card-body pt-0">
                                        <div class="text-center">
                                            <!-- Avatar -->
                                            <div class="avatar avatar-lg mt-n5 mb-3">
                                                <a href="#!"><img class="avatar-img rounded border border-white border-3" src="@GetProfilePicturePath(user.ProfilePictureId)" alt=""></a>
                                            </div>
                                            <!-- Info -->
                                            <h3 class="mb-0"><a>@user.NickName</a></h3>
                                            <h6 class="mb-0"> <a>@user.Name <b></b> @user.Surname</a> </h6>
                                            <!-- User stat START -->
                                            <div class="hstack gap-2 gap-xl-3 justify-content-center">
                                                <!-- User stat item -->
                                                <div>
                                                    <h6 class="mb-0">@user.Posts.Count</h6>
                                                    <small>Gönderiler</small>
                                                </div>
                                                <!-- Divider -->
                                                <div class="vr"></div>
                                                <!-- User stat item -->
                                                <div>
                                                    <h6 class="mb-0">@user.Followers.Count</h6>
                                                    <small>Takipçiler</small>
                                                </div>
                                                <!-- Divider -->
                                                <div class="vr"></div>
                                                <!-- User stat item -->
                                                <div>
                                                    <h6 class="mb-0">@user.Follows.Count</h6>
                                                    <small>Takip Edilenler</small>
                                                </div>
                                            </div>
                                            <!-- User stat END -->
                                        </div>

                                        <!-- Divider -->
                                        <hr>

                                        <!-- Side Nav START -->
                                        <ul class="nav nav-link-secondary flex-column fw-bold gap-2">
                                            <li class="nav-item">
                                                <a class="nav-link" href="my-profile"> <img class="me-2 h-20px fa-fw" src="assets/images/icon/home-outline-filled.svg" alt=""><span>Anasayfa</span></a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" href="my-profile-connections"> <img class="me-2 h-20px fa-fw" src="assets/images/icon/person-outline-filled.svg"  alt=""><span>Bağlantılarım</span></a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" href="notifications.html"> <img class="me-2 h-20px fa-fw" src="assets/images/icon/notification-outlined-filled.svg" alt=""><span>Bildirimler</span></a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" href="profileSetting"> <img class="me-2 h-20px fa-fw" src="assets/images/icon/cog-outline-filled.svg" alt=""><span>Ayarlar</span></a>
                                            </li>
                                        </ul>
                                        <!-- Side Nav END -->
                                    </div>
                                    <!-- Card body END -->
                                    <!-- Card footer -->
                                    <div class="card-footer text-center py-2">
                                        <a class="btn btn-link btn-sm" href="my-profile">Profilini Görüntüle </a>
                                    </div>
                                </div>
                                <!-- Card END -->
                                <!-- Helper link START -->
                                <ul class="nav small mt-4 justify-content-center lh-1">
                                  
                                    <li class="nav-item">
                                        <a class="nav-link" href="profileSetting">Ayarlar</a>
                                    </li>
                                   
    
                                    
                                </ul>
                                <!-- Helper link END -->
                                <!-- Copyright -->
                                <p class="small text-center mt-1">©2024 <a class="text-reset" target="_blank" href="https://github.com/sserkanyilmaz/"> Coin Market </a></p>
                            </div>
                        </div>
                    </nav>
                    <!-- Navbar END-->
                </div>
                <!-- Sidenav END -->
                <!-- Main content START -->
                <div class="col-md-8 col-lg-6 vstack gap-4">

                    <!-- Share feed START -->
                    <div class="card card-body">
                        <div class="d-flex mb-3">
                            <!-- Avatar -->
                            <div class="avatar avatar-xs me-2">
                                <a href="#"> <img class="avatar-img rounded-circle" src="@GetProfilePicturePath(user.ProfilePictureId)" alt=""> </a>
                            </div>
                            <!-- Post input -->
                            <form class="w-100">
                                <input class="form-control pe-4 border-0" @bind="newPost.Title" placeholder="Post Başlığı" data-bs-toggle="modal" data-bs-target="#modalCreateFeed">
                                <input class="form-control pe-4 border-0" @bind="newPost.Content" placeholder="Fikirlerini paylaş..." data-bs-toggle="modal" data-bs-target="#modalCreateFeed">
                                <button type="button" class="btn btn-success-soft" @onclick="@(async () => await SubmitPost())">Gönder</button>
                            </form>
                        </div>
                        <!-- Share feed toolbar START -->
                        <!--<ul class="nav nav-pills nav-stack small fw-normal">
            <li class="nav-item">
                <a class="nav-link bg-light py-1 px-2 mb-0" href="#!" data-bs-toggle="modal" data-bs-target="#feedActionPhoto"> <i class="bi bi-image-fill text-success pe-2"></i>Photo</a>
            </li>
            <li class="nav-item dropdown ms-sm-auto">
                <a class="nav-link bg-light py-1 px-2 mb-0" href="#" id="feedActionShare" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="bi bi-three-dots"></i>
                </a>
            </li>
        </ul>-->
                        <!-- Share feed toolbar END -->
                    </div>
                    @inject IJSRuntime jsRuntime

                    <h3>TradingView Chart</h3>

                    <div class="tradingview-widget-container" style="height:100%;width:100%">
                        <div id="tradingview_advanced_chart" class="tradingview-widget-container__widget" style="height:calc(100% - 32px);width:100%"></div>
                        <div class="tradingview-widget-copyright">
                            <a href="https://www.tradingview.com/" rel="noopener nofollow" target="_blank">
                                <span class="blue-text">Track all markets on TradingView</span>
                            </a>
                        </div>
                    </div>
                    <!-- Share feed END -->
                    <!-- Card feed item START -->
                    @foreach (var post in Posts)
                    {
                        <div class="card">
                            <div class="container">
                                <div class="card-header">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="d-flex align-items-center">
                                            <div class="avatar">
                                                <a @onclick="() => NavigateToProfile(post.OwnersName)"><img class="avatar-img rounded-circle" src="@GetProfilePicturePath(post.ProfilePictureId)" alt="Profile Picture"></a>
                                            </div>
                                            <div>
                                                <button class="btn btn-link" @onclick="() => NavigateToProfile(post.OwnersName)">
                                                    @post.OwnersName
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <p>@post.Content</p>
                                    <ul class="nav nav-stack py-3 small">
                                        <li class="nav-item">
                                            <a class="nav-link active" @onclick="() => LikePost(post.Id)">
                                                <i class="bi bi-hand-thumbs-up-fill"></i> Beğen (@post.LikeCount)
                                            </a>
                                        </li>

                                    </ul>
                                </div>
                                <div class="d-flex mb-3">
                                    <div class="avatar avatar-xs">
                                        <a href="#!"><img class="avatar-img rounded-circle" src="@GetProfilePicturePath(user.ProfilePictureId)" alt="User Avatar"></a>
                                    </div>
                                    <form class="position-relative w-100">
                                        <textarea class="form-control pe-4 bg-light" rows="1" @bind="addComment.Content" placeholder="Yorum ekle..."></textarea>
                                        <button class="nav-link bg-transparent px-3 position-absolute top-50 end-0 translate-middle-y border-0" type="button" @onclick="@(async () => await SubmitComment(post.Id))">
                                            <i class="bi bi-send-fill"> </i>
                                        </button>
                                    </form>

                                </div>
                                <ul class="list-unstyled">
                                    @foreach (var comment in post.Comments)
                                    {
                                        <li class="comment-item mb-2">
                                            <div class="d-flex">
                                                <div class="avatar avatar-xs">
                                                    <a href="#!"><img class="avatar-img rounded-circle" src="@GetProfilePicturePath(comment.ProfilePictureId)" alt="Comment Avatar"></a>
                                                </div>
                                                <div class="ms-2">
                                                    <div class="bg-light rounded p-3">
                                                        <button class="btn btn-link" @onclick="() => NavigateToProfile(comment.OwnersName)">
                                                            @comment.OwnersName
                                                        </button>
                                                        <p class="small mb-0">@comment.Content</p>
                                                    </div>
                                                    <ul class="nav py-2 small">
                                                        <li class="nav-item">
                                                            <a class="nav-link active" href="#" @onclick="() => LikeComment(comment.Id)">
                                                                <i class="bi bi-hand-thumbs-up-fill"></i> Liked (@comment.LikeCount)
                                                            </a>
                                                        </li>

                                                    </ul>
                                                </div>
                                            </div>
                                        </li>
                                    }
                                </ul>
                            </div>
                        </div>
                    }


                </div>
                <div class="col-lg-3">
                    <div class="row g-4">
                        <!-- Card follow START -->
                        <div class="col-sm-6 col-lg-12">
                            <div class="card">
                                <!-- Card header START -->
                                <div class="card-header pb-0 border-0">
                                    <h5 class="card-title mb-0">Kimi Takip Etmeli</h5>
                                </div>
                                <!-- Card header END -->
                                <!-- Card body START -->
                                @foreach (var user in response.UserDtos)
                                {
                                    <div class="card-body">

                                        <div class="hstack gap-2 mb-3">
                                            <div class="avatar">
                                                <a href="#!"><img class="avatar-img rounded-circle" src="@GetProfilePicturePath(user.ProfilePictureId)" alt=""></a>
                                            </div>
                                            <!-- Title -->
                                            <div class="overflow-hidden">
                                                <a class="h6 mb-0" href="#!">@user.Name</a>
                                                <p class="mb-0 small text-truncate">@user.NickName</p>
                                            </div>
                                            <!-- Button -->
                                            <button class="btn btn-primary-soft rounded-circle icon-md ms-auto" @onclick="() => FollowUser(user.Id)">
                                                +
                                            </button>
                                        </div>

                                    </div>
                                }
                                <!-- Card body END -->
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Card body END -->
            </div>
            <!-- Card feed item END -->

         
        </div>
        <!-- Main content END -->
        <!-- Right sidebar START -->
        

        <!-- Right sidebar END -->
        <!-- Row END -->
        <!-- Container END -->

    </main>
    <!-- **************** MAIN CONTENT END **************** -->
    <!-- Main Chat START -->
    
    <!-- Main Chat END -->
    <!-- Modal create Feed START -->
    <!-- Modal create feed END -->
    <!-- Modal create Feed photo START -->
    
    <!-- Modal create Feed photo END -->
    <!-- Modal create Feed video START -->
 
    <!-- Modal create Feed video END -->
    <!-- Modal create events START -->
    
    <!-- Modal create events END -->
    <!-- =======================
    JS libraries, plugins and custom scripts -->
    <!-- Bootstrap JS -->
    <!--<script src="assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>-->

    <!-- Vendors -->
    <!--<script src="assets/vendor/tiny-slider/dist/tiny-slider.js"></script>
    <script src="assets/vendor/OverlayScrollbars-master/js/OverlayScrollbars.min.js"></script>
    <script src="assets/vendor/choices.js/public/assets/scripts/choices.min.js"></script>
    <script src="assets/vendor/glightbox-master/dist/js/glightbox.min.js"></script>
    <script src="assets/vendor/flatpickr/dist/flatpickr.min.js"></script>
    <script src="assets/vendor/plyr/plyr.js"></script>
    <script src="assets/vendor/dropzone/dist/min/dropzone.min.js"></script>
    <script src="assets/vendor/zuck.js/dist/zuck.min.js"></script>
    <script src="assets/js/zuck-stories.js"></script>-->

    <!-- Theme Functions -->
    <!--<script src="assets/js/functions.js"></script>-->


</body>

<!-- Mirrored from social.webestica.com/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 01 May 2024 09:27:55 GMT -->
</html>


@code{
    public List<User> Users { get; set; } = new List<User>();
    public string UserId { get; set; } = "";
    public GetAllUserExceptUsersFolloweesResponse response =new GetAllUserExceptUsersFolloweesResponse();
    public GetByIdUser user = new GetByIdUser();
    public List<GetAllPost> Posts { get; set; } = new List<GetAllPost>();
    AddComment addComment = new();
    AddPost newPost = new();
    AddLikeComment addLikeComment = new();
    public List<Comment> Comments { get; set; } = new List<Comment>();


    [CascadingParameter] MudDialogInstance MudDialog { get; set; }

    protected override async Task OnInitializedAsync()
    {
        await PostLoad();
        UserId = await localStorage.GetItemAsync<string>("UserId");
        Users = (await _userService.GetAllUserListAsync(0, 100)).Data.UsersDTOs;
        response = (await _userService.GetAllUsersExceptUsersFollowees(new GetAllUserExceptUsersFollowees() { Id = UserId })).Data;
        user = (await _userService.GetUserByIdAsync(UserId)).Data;
        var allComment = (await _commentService.GetAllCommentListAsync(0, 100)).Data.Comments;
    }


    private async Task PostLoad()
    {
        Posts = (await _postService.GetAllPostAsync(0, 100)).Data.Posts.Select(p => p.Adapt<GetAllPost>()).Reverse().ToList();
        var postsList = (await _postService.GetAllPostAsync(0, 100)).Data.Posts;
        Posts = postsList.Select(p =>
        {
            var post = p.Adapt<GetAllPost>();
            post.PostOfUser = Users.FirstOrDefault(u => u.Id == post.UserId).Adapt<UserDTO>(); // Assuming posts have an OwnerId property
            return post;
        }).Reverse().ToList();
    }

    private async Task FollowUser(string followId)
    {
        var result = await _userService.FollowUserAsync(new FollowUser() { user1 = UserId, user2 = followId });

        if (result.IsSucceeded)
        {
            _snackbar.Add($"{result.Data.Name}'i başarıyla takip ettiniz.", Severity.Success);
        }
        else if (result.Message == "User Already Followed")
        {
            _snackbar.Add($"{result.Data.Name} zaten takip ediliyor.", Severity.Info);
        }
        else
        {
            _snackbar.Add($"Kullanıcı zaten takip ediliyor: {result.Message}", Severity.Error);
        }
    }

    async Task SubmitComment(string PostId)
    {
        try
        {
            addComment.UserId = UserId;
            addComment.PostId = PostId;
            var result = await _commentService.AddCommentAsync(addComment);
            if (result.IsSucceeded)
            {
                _snackbar.Add("Comment added successfully", Severity.Success);
                MudDialog.Close(DialogResult.Ok(true));
            }
            else
            {
                _snackbar.Add($"Failed to add comment: {result.Message}", Severity.Error);
            }
        }
        catch (Exception ex)
        {
            _snackbar.Add($"Exception during comment submission: {ex.Message}", Severity.Error);
        }
    }

    private async Task LikePost(string postId)
    {
        var addLikePost = new AddLikePost
        {
            Id = postId,
            UserID = UserId
        };

        try
        {
            var result = await _postService.LikePostAsync(addLikePost);
            if (result.IsSucceeded)
            {
                _snackbar.Add("Post liked successfully!", Severity.Success);
            }
            else
            {
                _snackbar.Add(result.Message, Severity.Warning);
            }
        }
        catch (Exception ex)
        {
            _snackbar.Add($"Failed to like post: {ex.Message}", Severity.Error);
        }
    }
    string GetProfilePicturePath(int profilePictureId)
    {
        return $"assets/profiles/Profile{profilePictureId}.jpg";
    }
    private async Task LikeComment(string CommentId)
    {
        await _commentService.LikeCommentAsync(new() { Id = CommentId, UserId = UserId});
    }
    void NavigateToProfile(string nickname)
    {
        NavigationManager.NavigateTo($"/Profile/{nickname}");
    }

    async Task SubmitPost()
    {
        newPost.UserId = this.UserId;
        try
        {
            var result = await _postService.AddPostAsync(newPost);
            if (result.IsSucceeded)
            {
                _snackbar.Add("Post added successfully", Severity.Success);
            }
            else
            {
                _snackbar.Add($"Failed to add post: {result.Message}", Severity.Error);
            }
        }
        catch (Exception ex)
        {
            _snackbar.Add($"Exception during post submission: {ex.Message}", Severity.Error);
        }
    }
}